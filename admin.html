<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin â€“ Mines Game</title>

<!-- Firebase Compat SDK -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;700;900&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   VARIABLES & RESET
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
:root {
  --gold:          #f0c040;
  --neon-cyan:     #22d3ee;
  --neon-emerald:  #34d399;
  --neon-amber:    #fbbf24;
  --neon-rose:     #fb7185;
  --neon-blue:     #60a5fa;
  --neon-purple:   #a78bfa;
  --bg-deep:       #0a0c14;
  --glass-bg:      rgba(18, 22, 40, 0.85);
  --glass-border:  rgba(255,255,255,0.11);
  --glass-border2: rgba(255,255,255,0.20);
  --text-primary:  #f0f0f5;
  --text-muted:    #9aa0b8;
  --radius:        16px;
  --radius-sm:     10px;
  --blur-main:     22px;
}
*, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }

html, body {
  min-height:100vh;
  font-family:'Rajdhani', sans-serif;
  background: var(--bg-deep);
  color: var(--text-primary);
  overflow-x: hidden;
  -webkit-font-smoothing: antialiased;
}

/* â”€â”€â”€ Canvas BG â”€â”€â”€ */
#bgCanvas {
  position:fixed; top:0; left:0;
  width:100%; height:100%;
  z-index:0; pointer-events:none;
}
body::before {
  content:'';
  position:fixed; inset:0; z-index:1;
  pointer-events:none; opacity:.035;
  background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
  background-size:200px 200px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LOGIN SCREEN
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.login-screen {
  position:relative; z-index:2;
  display:flex; justify-content:center; align-items:center;
  min-height:100vh; padding:20px;
}
.login-box {
  background: rgba(18,22,40,0.78);
  backdrop-filter: blur(var(--blur-main)) saturate(1.4);
  -webkit-backdrop-filter: blur(var(--blur-main)) saturate(1.4);
  border: 1.5px solid var(--glass-border2);
  border-radius: var(--radius);
  box-shadow: 0 8px 44px rgba(0,0,0,.55), inset 0 1px 0 rgba(255,255,255,.07);
  padding:44px 36px 40px;
  max-width:380px; width:100%;
  text-align:center;
}
.login-title {
  font-family:'Orbitron', sans-serif;
  font-size:28px; font-weight:900;
  letter-spacing:6px;
  background: linear-gradient(135deg, #f0c040, #fbbf24, #f59e0b);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
  filter: drop-shadow(0 0 16px rgba(240,192,64,.4));
  margin-bottom:6px;
}
.login-sub {
  font-size:13px; color:var(--text-muted);
  letter-spacing:2px; margin-bottom:28px;
}
.login-input {
  width:100%; padding:14px 18px; margin:10px 0;
  background: rgba(12,15,26,0.78);
  border: 1.5px solid var(--glass-border2);
  border-radius: var(--radius-sm);
  font-family:'Rajdhani', sans-serif;
  font-size:17px; font-weight:500;
  color: var(--text-primary); outline:none;
  transition: border-color .25s, box-shadow .25s;
}
.login-input::placeholder { color:var(--text-muted); }
.login-input:focus {
  border-color: var(--neon-cyan);
  box-shadow: 0 0 14px rgba(34,211,238,.25);
}
.login-btn {
  width:100%; padding:15px; margin-top:14px;
  background: rgba(52,211,153,.18);
  border: 1.5px solid rgba(52,211,153,.55);
  border-radius: var(--radius-sm);
  font-family:'Rajdhani', sans-serif;
  font-size:18px; font-weight:700;
  letter-spacing:2px; color: var(--neon-emerald);
  cursor:pointer; text-transform:uppercase;
  box-shadow: 0 0 14px rgba(52,211,153,.18);
  transition: transform .18s, box-shadow .25s, background .22s;
}
.login-btn:hover { transform:translateY(-2px); box-shadow:0 0 26px rgba(52,211,153,.4); background:rgba(52,211,153,.28); }
.login-btn:active { transform:translateY(0); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DASHBOARD
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.dashboard {
  position:relative; z-index:2;
  display:none;
  max-width:1200px; margin:0 auto;
  padding:22px 18px 48px;
}
.dashboard.active { display:block; }

/* â”€â”€â”€ Header â”€â”€â”€ */
.dash-header {
  display:flex; justify-content:space-between; align-items:center;
  flex-wrap:wrap; gap:12px;
  margin-bottom:22px;
}
.dash-title {
  font-family:'Orbitron', sans-serif;
  font-size:24px; font-weight:900;
  letter-spacing:5px;
  background: linear-gradient(135deg, #f0c040, #fbbf24);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
  filter: drop-shadow(0 0 12px rgba(240,192,64,.35));
}
.dash-logout {
  padding:10px 22px; border-radius: var(--radius-sm);
  background: rgba(251,113,133,.15);
  border: 1.5px solid rgba(251,113,133,.5);
  color: var(--neon-rose);
  font-family:'Rajdhani', sans-serif;
  font-size:15px; font-weight:700;
  letter-spacing:1px; cursor:pointer;
  text-transform:uppercase;
  transition: background .2s, box-shadow .2s;
}
.dash-logout:hover { background:rgba(251,113,133,.26); box-shadow:0 0 18px rgba(251,113,133,.3); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   STAT CARDS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.stats-row {
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap:14px; margin-bottom:22px;
}
.stat-card {
  background: rgba(18,22,40,0.72);
  backdrop-filter: blur(16px);
  -webkit-backdrop-filter: blur(16px);
  border: 1.5px solid var(--glass-border2);
  border-radius: var(--radius);
  box-shadow: 0 6px 28px rgba(0,0,0,.4), inset 0 1px 0 rgba(255,255,255,.06);
  padding:20px 16px; text-align:center;
  position:relative; overflow:hidden;
}
.stat-card::before {
  content:'';
  position:absolute; top:0; left:10%; right:10%; height:2px;
  background: var(--card-glow, var(--neon-cyan));
  filter: blur(3px);
  opacity:.7;
}
.stat-card[data-color="cyan"]   { --card-glow: var(--neon-cyan); }
.stat-card[data-color="emerald"]{ --card-glow: var(--neon-emerald); }
.stat-card[data-color="amber"]  { --card-glow: var(--neon-amber); }
.stat-card[data-color="purple"] { --card-glow: var(--neon-purple); }

.stat-label {
  font-size:11px; color:var(--text-muted);
  letter-spacing:2.2px; text-transform:uppercase; margin-bottom:8px;
}
.stat-value {
  font-family:'Orbitron', sans-serif;
  font-size:28px; font-weight:700;
  color: var(--gold);
  text-shadow: 0 0 10px rgba(240,192,64,.4);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TABS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.tabs {
  display:flex; gap:8px; margin-bottom:18px;
  flex-wrap:wrap;
}
.tab {
  padding:11px 22px; border-radius: var(--radius-sm);
  background: rgba(18,22,40,0.65);
  border: 1.5px solid var(--glass-border);
  color: var(--text-muted);
  font-family:'Rajdhani', sans-serif;
  font-size:15px; font-weight:600;
  letter-spacing:1px; cursor:pointer;
  text-transform:uppercase;
  transition: background .22s, border-color .22s, color .22s, box-shadow .25s;
}
.tab:hover { border-color: rgba(255,255,255,.25); color:var(--text-primary); }
.tab.active {
  background: rgba(240,192,64,.15);
  border-color: rgba(240,192,64,.55);
  color: var(--gold);
  box-shadow: 0 0 16px rgba(240,192,64,.22);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TAB CONTENT
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.tab-content { display:none; }
.tab-content.active { display:block; }

.tab-heading {
  font-family:'Orbitron', sans-serif;
  font-size:14px; font-weight:600;
  letter-spacing:3px; color:var(--text-muted);
  text-transform:uppercase;
  margin-bottom:14px; padding-bottom:10px;
  border-bottom:1px solid var(--glass-border);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CARDS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.card {
  background: rgba(14,18,32,0.72);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border: 1.5px solid var(--glass-border);
  border-radius: var(--radius-sm);
  box-shadow: 0 4px 20px rgba(0,0,0,.38), inset 0 1px 0 rgba(255,255,255,.05);
  padding:18px 18px 16px;
  margin-bottom:12px;
  transition: border-color .22s;
}
.card:hover { border-color: var(--glass-border2); }

.card-header {
  display:flex; justify-content:space-between;
  align-items:flex-start; flex-wrap:wrap; gap:10px;
  margin-bottom:10px;
}
.card-title {
  font-family:'Orbitron', sans-serif;
  font-size:14px; font-weight:700;
  color:var(--text-primary); letter-spacing:1px;
}
.card-info {
  font-size:14px; color:var(--text-muted);
  margin:4px 0; line-height:1.5;
}
.card-amount {
  font-family:'Orbitron', sans-serif;
  font-size:22px; font-weight:700;
  color:var(--gold);
  text-shadow: 0 0 8px rgba(240,192,64,.35);
  margin:8px 0;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ACTION BUTTONS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.btn-row { display:flex; gap:8px; flex-wrap:wrap; margin-top:10px; }
.btn-action {
  padding:9px 18px; border-radius: var(--radius-sm);
  font-family:'Rajdhani', sans-serif;
  font-size:14px; font-weight:700;
  letter-spacing:1px; cursor:pointer;
  border:1.5px solid; text-transform:uppercase;
  transition: transform .18s, box-shadow .25s, background .22s;
}
.btn-action:hover { transform:translateY(-1px); }
.btn-action:active { transform:translateY(0); }

.btn-approve {
  color:var(--neon-emerald);
  background:rgba(52,211,153,.16);
  border-color:rgba(52,211,153,.5);
  box-shadow:0 0 10px rgba(52,211,153,.15);
}
.btn-approve:hover { box-shadow:0 0 20px rgba(52,211,153,.35); background:rgba(52,211,153,.24); }

.btn-reject {
  color:var(--neon-rose);
  background:rgba(251,113,133,.15);
  border-color:rgba(251,113,133,.5);
  box-shadow:0 0 10px rgba(251,113,133,.15);
}
.btn-reject:hover { box-shadow:0 0 20px rgba(251,113,133,.35); background:rgba(251,113,133,.24); }

.btn-delete {
  color:var(--neon-amber);
  background:rgba(251,191,36,.13);
  border-color:rgba(251,191,36,.45);
  box-shadow:0 0 10px rgba(251,191,36,.13);
}
.btn-delete:hover { box-shadow:0 0 20px rgba(251,191,36,.3); background:rgba(251,191,36,.22); }

.btn-edit {
  color:var(--neon-blue);
  background:rgba(96,165,250,.15);
  border-color:rgba(96,165,250,.48);
  box-shadow:0 0 10px rgba(96,165,250,.13);
}
.btn-edit:hover { box-shadow:0 0 20px rgba(96,165,250,.32); background:rgba(96,165,250,.24); }

.btn-kick {
  color:var(--neon-purple);
  background:rgba(167,139,250,.14);
  border-color:rgba(167,139,250,.48);
  box-shadow:0 0 10px rgba(167,139,250,.13);
}
.btn-kick:hover { box-shadow:0 0 20px rgba(167,139,250,.32); background:rgba(167,139,250,.24); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   STATUS BADGES
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.badge {
  display:inline-block;
  font-size:11px; font-weight:700;
  letter-spacing:1px; text-transform:uppercase;
  padding:4px 10px; border-radius:20px;
}
.badge-online {
  color: var(--neon-emerald);
  background: rgba(52,211,153,.14);
  border: 1px solid rgba(52,211,153,.4);
  box-shadow: 0 0 6px rgba(52,211,153,.18);
}
.badge-offline {
  color: var(--text-muted);
  background: rgba(150,150,150,.1);
  border: 1px solid rgba(150,150,150,.2);
}
.badge-pending {
  color: var(--neon-amber);
  background: rgba(251,191,36,.12);
  border: 1px solid rgba(251,191,36,.4);
  box-shadow: 0 0 6px rgba(251,191,36,.15);
}
.badge-approved {
  color: var(--neon-emerald);
  background: rgba(52,211,153,.14);
  border: 1px solid rgba(52,211,153,.4);
}
.badge-rejected {
  color: var(--neon-rose);
  background: rgba(251,113,133,.14);
  border: 1px solid rgba(251,113,133,.4);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MODAL
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.modal-overlay {
  display:none; position:fixed; inset:0;
  background: rgba(4,5,10,0.78);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  z-index:1000;
  justify-content:center; align-items:center;
  padding:20px;
}
.modal-overlay.active { display:flex; }

.modal-box {
  background: rgba(14,18,32,0.88);
  backdrop-filter: blur(28px) saturate(1.3);
  -webkit-backdrop-filter: blur(28px) saturate(1.3);
  border: 1.5px solid var(--glass-border2);
  box-shadow: 0 14px 52px rgba(0,0,0,.58), inset 0 1px 0 rgba(255,255,255,.07);
  padding:32px 28px;
  border-radius: var(--radius);
  max-width:500px; width:100%;
}
.modal-title {
  font-family:'Orbitron', sans-serif;
  font-size:18px; font-weight:700;
  color:var(--gold); text-align:center;
  letter-spacing:2px; margin-bottom:22px;
  text-shadow: 0 0 12px rgba(240,192,64,.35);
}
.modal-input {
  width:100%; padding:14px 16px; margin:18px 0 10px;
  background: rgba(12,15,26,0.78);
  border: 1.5px solid var(--glass-border2);
  border-radius: var(--radius-sm);
  font-family:'Rajdhani', sans-serif;
  font-size:18px; font-weight:600;
  color:var(--text-primary); outline:none;
  transition: border-color .25s, box-shadow .25s;
}
.modal-input:focus {
  border-color:var(--neon-cyan);
  box-shadow:0 0 14px rgba(34,211,238,.25);
}
.modal-btns { display:flex; gap:10px; margin-top:8px; }
.modal-btns .btn-action { flex:1; text-align:center; }

/* â”€â”€â”€ Reject Modal â”€â”€â”€ */
.reject-reason-box {
  background: rgba(251,113,133,0.1);
  border: 1.5px solid rgba(251,113,133,0.3);
  border-radius: var(--radius-sm);
  padding: 16px;
  margin: 16px 0;
}
.reason-title {
  color: var(--neon-rose);
  font-family: 'Orbitron', sans-serif;
  font-size: 14px;
  font-weight: 700;
  margin-bottom: 8px;
  letter-spacing: 1px;
}
.reason-options {
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-bottom: 12px;
}
.reason-option {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  background: rgba(255,255,255,0.05);
  border-radius: var(--radius-sm);
  cursor: pointer;
  transition: all 0.2s ease;
}
.reason-option:hover {
  background: rgba(251,113,133,0.15);
}
.reason-option input[type="radio"] {
  width: 16px;
  height: 16px;
}
.reason-text {
  font-size: 14px;
  color: var(--text-primary);
}
.custom-reason-input {
  width: 100%;
  padding: 12px;
  background: rgba(12,15,26,0.6);
  border: 1.5px solid rgba(251,113,133,0.3);
  border-radius: var(--radius-sm);
  color: var(--text-primary);
  font-family: 'Rajdhani', sans-serif;
  font-size: 14px;
  margin-top: 8px;
  display: none;
}
.custom-reason-input.active {
  display: block;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCROLLBAR
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
::-webkit-scrollbar { width:8px; }
::-webkit-scrollbar-track { background:rgba(255,255,255,0.05); border-radius:4px; }
::-webkit-scrollbar-thumb { background:rgba(240,192,64,0.3); border-radius:4px; }
::-webkit-scrollbar-thumb:hover { background:rgba(240,192,64,0.5); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESPONSIVE
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@media(max-width:540px){
  .dashboard      { padding:16px 12px 40px; }
  .dash-title     { font-size:18px; letter-spacing:3px; }
  .stat-value     { font-size:22px; }
  .tab            { padding:9px 16px; font-size:13px; }
  .card-amount    { font-size:19px; }
  .modal-box      { padding:24px 18px; }
}
</style>
</head>
<body>

<!-- â•â•â• PARTICLE CANVAS â•â•â• -->
<canvas id="bgCanvas"></canvas>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     LOGIN
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="loginScreen" class="login-screen">
  <div class="login-box">
    <div class="login-title">ADMIN</div>
    <div class="login-sub">ğŸ” SECURE ACCESS</div>
    <input type="password" id="adminPassword" class="login-input"
           placeholder="Enter Password"
           onkeydown="if(event.key==='Enter') adminLogin()">
    <button class="login-btn" onclick="adminLogin()">Login</button>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     DASHBOARD
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="dashboard" class="dashboard">

  <!-- Header -->
  <div class="dash-header">
    <div class="dash-title">ğŸ® ADMIN DASHBOARD</div>
    <button class="dash-logout" onclick="adminLogout()">Logout</button>
  </div>

  <!-- Stat Cards -->
  <div class="stats-row">
    <div class="stat-card" data-color="cyan">
      <div class="stat-label">Total Users</div>
      <div class="stat-value" id="totalUsers">0</div>
    </div>
    <div class="stat-card" data-color="emerald">
      <div class="stat-label">Online Now</div>
      <div class="stat-value" id="onlineUsers">0</div>
    </div>
    <div class="stat-card" data-color="amber">
      <div class="stat-label">Pending Deposits</div>
      <div class="stat-value" id="pendingDeposits">0</div>
    </div>
    <div class="stat-card" data-color="purple">
      <div class="stat-label">Pending Withdrawals</div>
      <div class="stat-value" id="pendingWithdrawals">0</div>
    </div>
  </div>

  <!-- Tabs -->
  <div class="tabs">
    <button class="tab active" onclick="showTab('deposits',this)">ğŸ’° Deposits</button>
    <button class="tab"        onclick="showTab('withdrawals',this)">ğŸ’¸ Withdrawals</button>
    <button class="tab"        onclick="showTab('users',this)">ğŸ‘¥ Users</button>
    <button class="tab"        onclick="showTab('lockedUsers',this)">ğŸ”’ Locked Users</button>
  </div>

  <!-- â”€â”€ DEPOSITS TAB â”€â”€ -->
  <div id="deposits" class="tab-content active">
    <div class="tab-heading">Deposit Requests - Pending Approval</div>
    <div id="depositsContent"><div style="text-align:center; padding:40px; color:var(--text-muted);">Loading deposits...</div></div>
  </div>

  <!-- â”€â”€ WITHDRAWALS TAB â”€â”€ -->
  <div id="withdrawals" class="tab-content">
    <div class="tab-heading">Withdrawal Requests - Pending Approval</div>
    <div id="withdrawalsContent"><div style="text-align:center; padding:40px; color:var(--text-muted);">Loading withdrawals...</div></div>
  </div>

  <!-- â”€â”€ USERS TAB â”€â”€ -->
  <div id="users" class="tab-content">
    <div class="tab-heading">All Users - Manage Accounts</div>
    <div id="usersContent"><div style="text-align:center; padding:40px; color:var(--text-muted);">Loading users...</div></div>
  </div>

  <!-- â”€â”€ LOCKED USERS TAB â”€â”€ -->
  <div id="lockedUsers" class="tab-content">
    <div class="tab-heading">Locked Users - 3+ Rejected Deposits</div>
    <div id="lockedUsersContent"><div style="text-align:center; padding:40px; color:var(--text-muted);">Loading locked users...</div></div>
  </div>
</div>

<!-- â•â•â• REJECT DEPOSIT MODAL â•â•â• -->
<div id="rejectDepositModal" class="modal-overlay">
  <div class="modal-box">
    <div class="modal-title">âŒ Reject Deposit Request</div>
    
    <div class="card">
      <div class="card-header">
        <div>
          <div class="card-title" id="rejectUserName">User Name</div>
          <div class="card-info" id="rejectUserPhone">Phone: </div>
          <div class="card-info" id="rejectAmount">Amount: Rs 0</div>
        </div>
      </div>
    </div>
    
    <div class="reject-reason-box">
      <div class="reason-title">Select Rejection Reason</div>
      <div class="reason-options">
        <label class="reason-option">
          <input type="radio" name="rejectReason" value="amount_not_received" checked>
          <span class="reason-text">Amount not received / Wrong amount</span>
        </label>
        <label class="reason-option">
          <input type="radio" name="rejectReason" value="screenshot_missing">
          <span class="reason-text">Payment screenshot missing</span>
        </label>
        <label class="reason-option">
          <input type="radio" name="rejectReason" value="fake_screenshot">
          <span class="reason-text">Fake/edited screenshot</span>
        </label>
        <label class="reason-option">
          <input type="radio" name="rejectReason" value="payment_method_wrong">
          <span class="reason-text">Wrong payment method used</span>
        </label>
        <label class="reason-option">
          <input type="radio" name="rejectReason" value="custom">
          <span class="reason-text">Other reason (custom)</span>
        </label>
      </div>
      
      <textarea id="customRejectReason" class="custom-reason-input" 
                placeholder="Enter custom rejection reason..."></textarea>
    </div>
    
    <div class="modal-btns">
      <button class="btn-action btn-reject" onclick="confirmRejectDeposit()">Reject & Send Message</button>
      <button class="btn-action" style="background:rgba(255,255,255,0.1); color:#fff;" onclick="closeModal('rejectDepositModal')">Cancel</button>
    </div>
  </div>
</div>

<!-- â•â•â• EDIT USER BALANCE MODAL â•â•â• -->
<div id="editBalanceModal" class="modal-overlay">
  <div class="modal-box">
    <div class="modal-title">âœï¸ Edit User Balance</div>
    
    <div style="margin-bottom:20px;">
      <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
        <span style="color:var(--text-muted);">User:</span>
        <span style="color:var(--text-primary); font-weight:600;" id="editUserName">-</span>
      </div>
      <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
        <span style="color:var(--text-muted);">Phone:</span>
        <span style="color:var(--text-primary); font-weight:600;" id="editUserPhone">-</span>
      </div>
      <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
        <span style="color:var(--text-muted);">Current Balance:</span>
        <span style="color:var(--gold); font-weight:600;" id="editCurrentBalance">Rs 0</span>
      </div>
    </div>
    
    <input type="number" id="editNewBalance" class="modal-input" placeholder="Enter new balance">
    
    <div class="modal-btns">
      <button class="btn-action btn-approve" onclick="saveUserBalance()">Save Balance</button>
      <button class="btn-action" style="background:rgba(255,255,255,0.1); color:#fff;" onclick="closeModal('editBalanceModal')">Cancel</button>
    </div>
  </div>
</div>

<!-- â•â•â• SEND MESSAGE MODAL â•â•â• -->
<div id="sendMessageModal" class="modal-overlay">
  <div class="modal-box">
    <div class="modal-title">ğŸ“¢ Send Message to User</div>
    
    <div style="margin-bottom:20px;">
      <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
        <span style="color:var(--text-muted);">To:</span>
        <span style="color:var(--text-primary); font-weight:600;" id="msgUserName">-</span>
      </div>
      <div style="display:flex; justify-content:space-between; margin-bottom:15px;">
        <span style="color:var(--text-muted);">Phone:</span>
        <span style="color:var(--text-primary); font-weight:600;" id="msgUserPhone">-</span>
      </div>
    </div>
    
    <textarea id="adminMessageText" class="modal-input" style="height:120px; resize:none;" 
              placeholder="Enter message for user..."></textarea>
    
    <div class="modal-btns">
      <button class="btn-action btn-approve" onclick="sendAdminMessage()">Send Message</button>
      <button class="btn-action" style="background:rgba(255,255,255,0.1); color:#fff;" onclick="closeModal('sendMessageModal')">Cancel</button>
    </div>
  </div>
</div>

<!-- â•â•â• BAN USER MODAL â•â•â• -->
<div id="banUserModal" class="modal-overlay">
  <div class="modal-box">
    <div class="modal-title">ğŸš« Ban User Permanently</div>
    
    <div style="margin-bottom:20px; text-align:center;">
      <div style="font-size:50px; margin-bottom:10px;">âš ï¸</div>
      <div style="color:var(--neon-rose); font-weight:700; margin-bottom:10px;" id="banUserName">User Name</div>
      <div style="color:var(--text-muted); margin-bottom:15px;" id="banUserPhone">Phone: </div>
      <div style="color:var(--text-muted); font-size:14px; line-height:1.5;">
        This will permanently ban the user from:<br>
        â€¢ Logging in on any device<br>
        â€¢ Creating new accounts with this phone<br>
        â€¢ Cannot be undone!
      </div>
    </div>
    
    <input type="text" id="banReason" class="modal-input" placeholder="Ban reason (optional)">
    
    <div class="modal-btns">
      <button class="btn-action btn-reject" onclick="confirmBanUser()">Permanent Ban</button>
      <button class="btn-action" style="background:rgba(255,255,255,0.1); color:#fff;" onclick="closeModal('banUserModal')">Cancel</button>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     PARTICLE ENGINE
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
(function(){
  const canvas = document.getElementById('bgCanvas');
  const ctx = canvas.getContext('2d');
  let W, H;
  function resize(){ W = canvas.width = window.innerWidth; H = canvas.height = window.innerHeight; }
  window.addEventListener('resize', resize); resize();

  const PART_COUNT = 90, SHARD_COUNT = 16;
  const PALETTE = [
    [34,211,238], [96,165,250], [52,211,153],
    [240,192,64], [251,191,36], [180,195,240]
  ];

  class Particle {
    constructor(){ this.reset(true); }
    reset(init){
      this.x = init ? Math.random()*W : (Math.random()<.5 ? -12 : W+12);
      this.y = init ? Math.random()*H : Math.random()*H;
      this.r = .5 + Math.random()*2.4;
      this.vx = (Math.random()-.5)*.38;
      this.vy = (Math.random()-.5)*.38;
      this.col = PALETTE[Math.floor(Math.random()*PALETTE.length)];
      this.alpha = .12 + Math.random()*.5;
      this.phase = Math.random()*Math.PI*2;
      this.freq = .35 + Math.random()*.55;
    }
    update(){
      this.x += this.vx;
      this.y += this.vy;
      this.phase += this.freq*.016;
      if(this.x < -30 || this.x > W+30 || this.y < -30 || this.y > H+30) this.reset(false);
    }
    draw(){
      const a = this.alpha + Math.sin(this.phase)*.13;
      const [r,g,b] = this.col;
      ctx.beginPath();
      ctx.arc(this.x, this.y, this.r, 0, Math.PI*2);
      ctx.fillStyle = `rgba(${r},${g},${b},${a})`;
      ctx.fill();
    }
  }

  class Shard {
    constructor(){ this.reset(true); }
    reset(init){
      this.x = init ? Math.random()*W : -70;
      this.y = init ? Math.random()*H : Math.random()*H;
      this.w = 2.5 + Math.random()*4;
      this.h = 28 + Math.random()*75;
      this.angle = -.52 + Math.random()*.25;
      this.speed = .28 + Math.random()*.32;
      this.alpha = .028 + Math.random()*.065;
      this.col = [195+Math.random()*60, 210+Math.random()*45, 255];
    }
    update(){ 
      this.x += this.speed; 
      if(this.x > W+100) this.reset(false); 
    }
    draw(){
      ctx.save();
      ctx.translate(this.x, this.y);
      ctx.rotate(this.angle);
      const g = ctx.createLinearGradient(0,0,0,this.h);
      const [r,gr,b] = this.col;
      g.addColorStop(0, `rgba(${r},${gr},${b},0)`);
      g.addColorStop(.28, `rgba(${r},${gr},${b},${this.alpha})`);
      g.addColorStop(.72, `rgba(${r},${gr},${b},${this.alpha})`);
      g.addColorStop(1, `rgba(${r},${gr},${b},0)`);
      ctx.fillStyle = g;
      ctx.fillRect(-this.w*.5, 0, this.w, this.h);
      ctx.restore();
    }
  }

  const particles = [], shards = [];
  for(let i=0; i<PART_COUNT; i++) particles.push(new Particle());
  for(let i=0; i<SHARD_COUNT; i++) shards.push(new Shard());

  function drawBg(){
    const g = ctx.createLinearGradient(0,0, W*.55, H);
    g.addColorStop(0, '#0a0c14');
    g.addColorStop(.4, '#0e1320');
    g.addColorStop(.72, '#111a2e');
    g.addColorStop(1, '#0c1118');
    ctx.fillStyle = g;
    ctx.fillRect(0,0,W,H);
  }

  function loop(){
    drawBg();
    shards.forEach(s => { s.update(); s.draw(); });
    particles.forEach(p => { p.update(); p.draw(); });
    requestAnimationFrame(loop);
  }
  loop();
})();
</script>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     FIREBASE INIT
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
// Initialize Firebase
const firebaseConfig = {
  apiKey: "AIzaSyA8C1-TpsRo0UsATshlI8Dy0v40PnLRlc4",
  authDomain: "mines-67d8c.firebaseapp.com",
  databaseURL: "https://mines-67d8c-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "mines-67d8c",
  storageBucket: "mines-67d8c.firebasestorage.app",
  messagingSenderId: "918317634273",
  appId: "1:918317634273:web:8527c0d58a1f3de0371da0",
  measurementId: "G-NHC6K1X3KZ"
};

let db = null;

function initFirebase(){
  try {
    if(!firebase.apps.length){
      firebase.initializeApp(firebaseConfig);
    }
    db = firebase.database();
    console.log('âœ… Firebase connected');
    loadData();
  } catch(err){
    console.error('âŒ Firebase init error:', err);
    alert('Firebase connection failed: ' + err.message);
  }
}

// Initialize on load
document.addEventListener('DOMContentLoaded', initFirebase);
</script>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ADMIN LOGIC
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
// Admin password
const ADMIN_PASSWORD = '@/Aa362014300';

// Global variables
let currentTab = 'deposits';
let currentRejectData = null;
let currentEditUser = null;
let currentMessageUser = null;
let currentBanUser = null;

// Login
function adminLogin(){
  const pw = document.getElementById('adminPassword').value;
  if(pw === ADMIN_PASSWORD){
    document.getElementById('loginScreen').style.display = 'none';
    document.getElementById('dashboard').classList.add('active');
    loadData();
  } else {
    alert('âŒ Wrong password!');
  }
}

// Logout
function adminLogout(){
  if(confirm('Are you sure you want to logout?')){
    location.reload();
  }
}

// Tab switching
function showTab(tabName, btn){
  currentTab = tabName;
  
  // Update active tab
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  btn.classList.add('active');
  
  // Show selected tab
  document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
  document.getElementById(tabName).classList.add('active');
  
  // Load data for tab
  if(tabName === 'deposits'){
    loadDeposits();
  } else if(tabName === 'withdrawals'){
    loadWithdrawals();
  } else if(tabName === 'users'){
    loadUsers();
  } else if(tabName === 'lockedUsers'){
    loadLockedUsers();
  }
}

// Load all data initially
function loadData(){
  if(!db) return;
  
  // Load deposits
  loadDeposits();
  
  // Load withdrawals
  loadWithdrawals();
  
  // Load users
  loadUsers();
  
  // Load stats
  updateStats();
  
  // Auto-refresh every 30 seconds
  setInterval(() => {
    if(currentTab === 'deposits') loadDeposits();
    else if(currentTab === 'withdrawals') loadWithdrawals();
    else if(currentTab === 'users') loadUsers();
    else if(currentTab === 'lockedUsers') loadLockedUsers();
    updateStats();
  }, 30000);
}

// Update statistics
async function updateStats(){
  try {
    const [usersSnap, depositsSnap, withdrawalsSnap] = await Promise.all([
      db.ref('users').once('value'),
      db.ref('depositRequests').once('value'),
      db.ref('withdrawRequests').once('value')
    ]);
    
    let totalUsers = 0;
    let onlineUsers = 0;
    let pendingDeposits = 0;
    let pendingWithdrawals = 0;
    
    // Count users
    if(usersSnap.exists()){
      const users = usersSnap.val();
      totalUsers = Object.keys(users).length;
      onlineUsers = Object.values(users).filter(u => u.isOnline).length;
    }
    
    // Count pending deposits
    if(depositsSnap.exists()){
      depositsSnap.forEach(child => {
        if(child.val().status === 'pending') pendingDeposits++;
      });
    }
    
    // Count pending withdrawals
    if(withdrawalsSnap.exists()){
      withdrawalsSnap.forEach(child => {
        if(child.val().status === 'pending') pendingWithdrawals++;
      });
    }
    
    // Update display
    document.getElementById('totalUsers').textContent = totalUsers;
    document.getElementById('onlineUsers').textContent = onlineUsers;
    document.getElementById('pendingDeposits').textContent = pendingDeposits;
    document.getElementById('pendingWithdrawals').textContent = pendingWithdrawals;
    
  } catch(e){
    console.error('Update stats error:', e);
  }
}

// Load deposits
async function loadDeposits(){
  try {
    const snapshot = await db.ref('depositRequests').orderByChild('timestamp').once('value');
    const content = document.getElementById('depositsContent');
    
    if(!snapshot.exists()){
      content.innerHTML = '<div style="text-align:center; padding:40px; color:var(--text-muted);">No deposit requests</div>';
      return;
    }
    
    let html = '';
    let hasPending = false;
    
    snapshot.forEach(child => {
      const deposit = child.val();
      
      // Show only pending deposits by default
      if(deposit.status === 'pending'){
        hasPending = true;
        const date = deposit.timestamp ? new Date(deposit.timestamp).toLocaleString() : 'N/A';
        const method = deposit.paymentMethod === 'jazzcash' ? 'JazzCash' : 'Easypaisa';
        
        html += `
          <div class="card">
            <div class="card-header">
              <div>
                <div class="card-title">${deposit.name || 'Unknown'}</div>
                <div class="card-info">ğŸ“± ${deposit.phone || 'N/A'}</div>
                <div class="card-info">ğŸ•’ ${date}</div>
                <div class="card-info">ğŸ’³ ${method}</div>
              </div>
              <span class="badge badge-pending">PENDING</span>
            </div>
            
            <div class="card-amount" style="color:var(--neon-emerald);">+ Rs ${deposit.amount || 0}</div>
            
            <div class="btn-row">
              <button class="btn-action btn-approve" onclick="approveDeposit('${child.key}', '${deposit.phone}', ${deposit.amount})">
                âœ… Approve
              </button>
              <button class="btn-action btn-reject" onclick="showRejectDepositModal('${child.key}', '${deposit.phone}', '${deposit.name}', ${deposit.amount})">
                âŒ Reject
              </button>
              <button class="btn-action" style="background:rgba(255,255,255,0.1); color:#fff;" onclick="viewUserDetails('${deposit.phone}')">
                ğŸ‘ View User
              </button>
            </div>
          </div>
        `;
      }
    });
    
    if(!hasPending){
      html = '<div style="text-align:center; padding:40px; color:var(--text-muted);">No pending deposit requests</div>';
    }
    
    content.innerHTML = html;
    
  } catch(e){
    console.error('Load deposits error:', e);
    document.getElementById('depositsContent').innerHTML = 
      '<div style="text-align:center; padding:40px; color:var(--neon-rose);">Error loading deposits</div>';
  }
}

// Load withdrawals
async function loadWithdrawals(){
  try {
    const snapshot = await db.ref('withdrawRequests').orderByChild('timestamp').once('value');
    const content = document.getElementById('withdrawalsContent');
    
    if(!snapshot.exists()){
      content.innerHTML = '<div style="text-align:center; padding:40px; color:var(--text-muted);">No withdrawal requests</div>';
      return;
    }
    
    let html = '';
    let hasPending = false;
    
    snapshot.forEach(child => {
      const withdrawal = child.val();
      
      // Show only pending withdrawals by default
      if(withdrawal.status === 'pending'){
        hasPending = true;
        const date = withdrawal.timestamp ? new Date(withdrawal.timestamp).toLocaleString() : 'N/A';
        const method = withdrawal.withdrawMethod === 'jazz' ? 'JazzCash' : 'Easypaisa';
        
        html += `
          <div class="card">
            <div class="card-header">
              <div>
                <div class="card-title">${withdrawal.name || 'Unknown'}</div>
                <div class="card-info">ğŸ“± ${withdrawal.phone || 'N/A'}</div>
                <div class="card-info">ğŸ’³ ${method}: ${withdrawal.jazzCash || 'N/A'}</div>
                <div class="card-info">ğŸ•’ ${date}</div>
              </div>
              <span class="badge badge-pending">PENDING</span>
            </div>
            
            <div class="card-amount" style="color:var(--neon-rose);">- Rs ${withdrawal.amount || 0}</div>
            
            <div class="btn-row">
              <button class="btn-action btn-approve" onclick="approveWithdrawal('${child.key}', '${withdrawal.phone}', ${withdrawal.amount})">
                âœ… Approve & Send
              </button>
              <button class="btn-action btn-reject" onclick="rejectWithdrawal('${child.key}', '${withdrawal.phone}')">
                âŒ Reject
              </button>
              <button class="btn-action" style="background:rgba(255,255,255,0.1); color:#fff;" onclick="viewUserDetails('${withdrawal.phone}')">
                ğŸ‘ View User
              </button>
            </div>
          </div>
        `;
      }
    });
    
    if(!hasPending){
      html = '<div style="text-align:center; padding:40px; color:var(--text-muted);">No pending withdrawal requests</div>';
    }
    
    content.innerHTML = html;
    
  } catch(e){
    console.error('Load withdrawals error:', e);
    document.getElementById('withdrawalsContent').innerHTML = 
      '<div style="text-align:center; padding:40px; color:var(--neon-rose);">Error loading withdrawals</div>';
  }
}

// Load users
async function loadUsers(){
  try {
    const snapshot = await db.ref('users').orderByChild('balance').once('value');
    const content = document.getElementById('usersContent');
    
    if(!snapshot.exists()){
      content.innerHTML = '<div style="text-align:center; padding:40px; color:var(--text-muted);">No users found</div>';
      return;
    }
    
    let html = '';
    const users = [];
    
    snapshot.forEach(child => {
      users.push({ phone: child.key, ...child.val() });
    });
    
    // Sort by balance (highest first)
    users.sort((a, b) => (b.balance || 0) - (a.balance || 0));
    
    users.forEach(user => {
      const badge = user.isOnline 
        ? '<span class="badge badge-online">â— Online</span>' 
        : '<span class="badge badge-offline">â— Offline</span>';
      
      const bannedBadge = user.banned 
        ? '<span class="badge badge-rejected" style="margin-left:8px;">ğŸš« BANNED</span>' 
        : '';
      
      const depositRejections = user.depositRejections || 0;
      const lockInfo = user.depositLockUntil && user.depositLockUntil > Date.now()
        ? `<div class="card-info" style="color:var(--neon-rose);">ğŸ”’ Locked until: ${new Date(user.depositLockUntil).toLocaleString()}</div>`
        : `<div class="card-info">âŒ Rejections: ${depositRejections}/3</div>`;
      
      html += `
        <div class="card">
          <div class="card-header">
            <div>
              <div class="card-title">${user.name || 'Unknown'} ${badge} ${bannedBadge}</div>
              <div class="card-info">ğŸ“± ${user.phone}</div>
              <div class="card-info">ğŸ’° Balance: Rs ${user.balance || 0}</div>
              ${lockInfo}
              <div class="card-info">ğŸ“… Joined: ${user.createdAt ? new Date(user.createdAt).toLocaleDateString() : 'N/A'}</div>
            </div>
          </div>
          
          <div class="btn-row">
            <button class="btn-action btn-edit" onclick="editUserBalance('${user.phone}', '${user.name || 'User'}', ${user.balance || 0})">
              âœï¸ Edit Balance
            </button>
            <button class="btn-action" style="background:rgba(96,165,250,0.15); color:var(--neon-blue);" 
                    onclick="sendMessageToUser('${user.phone}', '${user.name || 'User'}')">
              ğŸ“¢ Message
            </button>
            ${!user.banned ? `
              <button class="btn-action btn-kick" onclick="showBanUserModal('${user.phone}', '${user.name || 'User'}')">
                ğŸš« Ban User
              </button>
            ` : ''}
            <button class="btn-action btn-delete" onclick="deleteUser('${user.phone}', '${user.name || 'User'}')">
              ğŸ—‘ Delete
            </button>
          </div>
        </div>
      `;
    });
    
    content.innerHTML = html;
    
  } catch(e){
    console.error('Load users error:', e);
    document.getElementById('usersContent').innerHTML = 
      '<div style="text-align:center; padding:40px; color:var(--neon-rose);">Error loading users</div>';
  }
}

// Load locked users
async function loadLockedUsers(){
  try {
    const snapshot = await db.ref('users').once('value');
    const content = document.getElementById('lockedUsersContent');
    
    if(!snapshot.exists()){
      content.innerHTML = '<div style="text-align:center; padding:40px; color:var(--text-muted);">No locked users</div>';
      return;
    }
    
    let html = '';
    let hasLockedUsers = false;
    const now = Date.now();
    
    snapshot.forEach(child => {
      const user = child.val();
      
      // Check if user is locked (3+ rejections and lock not expired)
      const rejections = user.depositRejections || 0;
      const lockUntil = user.depositLockUntil || 0;
      
      if(rejections >= 3 && lockUntil > now){
        hasLockedUsers = true;
        const remaining = Math.ceil((lockUntil - now) / 60000); // minutes
        
        html += `
          <div class="card">
            <div class="card-header">
              <div>
                <div class="card-title">${user.name || 'Unknown'}</div>
                <div class="card-info">ğŸ“± ${child.key}</div>
                <div class="card-info">ğŸ’° Balance: Rs ${user.balance || 0}</div>
                <div class="card-info" style="color:var(--neon-rose);">
                  ğŸ”’ Locked for ${remaining} more minutes
                </div>
                <div class="card-info">
                  âŒ Rejections: ${rejections}/3
                </div>
              </div>
              <span class="badge badge-rejected">LOCKED</span>
            </div>
            
            <div class="btn-row">
              <button class="btn-action btn-approve" onclick="unlockUser('${child.key}')">
                ğŸ”“ Unlock Now
              </button>
              <button class="btn-action" style="background:rgba(96,165,250,0.15); color:var(--neon-blue);" 
                      onclick="sendMessageToUser('${child.key}', '${user.name || 'User'}')">
                ğŸ“¢ Message
              </button>
              <button class="btn-action btn-kick" onclick="showBanUserModal('${child.key}', '${user.name || 'User'}')">
                ğŸš« Ban User
              </button>
            </div>
          </div>
        `;
      }
    });
    
    if(!hasLockedUsers){
      html = '<div style="text-align:center; padding:40px; color:var(--text-muted);">No locked users found</div>';
    }
    
    content.innerHTML = html;
    
  } catch(e){
    console.error('Load locked users error:', e);
    document.getElementById('lockedUsersContent').innerHTML = 
      '<div style="text-align:center; padding:40px; color:var(--neon-rose);">Error loading locked users</div>';
  }
}

// Approve deposit
async function approveDeposit(requestId, userPhone, amount){
  if(!confirm(`Approve deposit of Rs ${amount}?\n\nBalance will be added to user's account.`)) return;
  
  try {
    // Get user data
    const userSnap = await db.ref(`users/${userPhone}`).once('value');
    if(!userSnap.exists()){
      alert('User not found!');
      return;
    }
    
    const user = userSnap.val();
    
    // Update user balance and reset rejections
    await db.ref(`users/${userPhone}`).update({
      balance: (user.balance || 0) + amount,
      totalDeposit: (user.totalDeposit || 0) + amount,
      depositRejections: 0, // Reset rejections
      depositLockUntil: null // Remove lock
    });
    
    // Update deposit request status
    await db.ref(`depositRequests/${requestId}`).update({
      status: 'approved',
      approvedAt: Date.now(),
      approvedBy: 'admin'
    });
    
    // Send success message to user
    const messageRef = db.ref('adminMessages').child(userPhone).push();
    await messageRef.set({
      message: `âœ… Your deposit of Rs ${amount} has been approved! Balance added to your account.`,
      timestamp: Date.now(),
      read: false
    });
    
    alert('âœ… Deposit approved successfully!\nBalance added to user account.');
    
    // Reload data
    loadDeposits();
    loadUsers();
    loadLockedUsers();
    updateStats();
    
  } catch(e){
    console.error('Approve deposit error:', e);
    alert('âŒ Error: ' + e.message);
  }
}

// Show reject deposit modal
function showRejectDepositModal(requestId, userPhone, userName, amount){
  currentRejectData = { requestId, userPhone, userName, amount };
  
  // Update modal content
  document.getElementById('rejectUserName').textContent = userName || 'Unknown';
  document.getElementById('rejectUserPhone').textContent = 'Phone: ' + userPhone;
  document.getElementById('rejectAmount').textContent = 'Amount: Rs ' + amount;
  
  // Reset custom reason input
  document.getElementById('customRejectReason').style.display = 'none';
  document.getElementById('customRejectReason').value = '';
  
  // Show modal
  document.getElementById('rejectDepositModal').classList.add('active');
}

// Handle reason selection
document.querySelectorAll('input[name="rejectReason"]').forEach(radio => {
  radio.addEventListener('change', function() {
    const customInput = document.getElementById('customRejectReason');
    if(this.value === 'custom'){
      customInput.style.display = 'block';
      customInput.classList.add('active');
    } else {
      customInput.style.display = 'none';
      customInput.classList.remove('active');
    }
  });
});

// Confirm reject deposit
async function confirmRejectDeposit(){
  if(!currentRejectData) return;
  
  const { requestId, userPhone, userName, amount } = currentRejectData;
  
  // Get selected reason
  const selectedReason = document.querySelector('input[name="rejectReason"]:checked').value;
  let reasonText = '';
  
  // Set reason text based on selection
  if(selectedReason === 'amount_not_received'){
    reasonText = 'Amount not received or wrong amount sent';
  } else if(selectedReason === 'screenshot_missing'){
    reasonText = 'Payment screenshot missing';
  } else if(selectedReason === 'fake_screenshot'){
    reasonText = 'Fake or edited payment screenshot';
  } else if(selectedReason === 'payment_method_wrong'){
    reasonText = 'Wrong payment method used';
  } else if(selectedReason === 'custom'){
    reasonText = document.getElementById('customRejectReason').value.trim();
    if(!reasonText){
      alert('Please enter a custom rejection reason!');
      return;
    }
  }
  
  if(!confirm(`Reject deposit of Rs ${amount}?\n\nReason: ${reasonText}`)) return;
  
  try {
    // Get user data
    const userSnap = await db.ref(`users/${userPhone}`).once('value');
    if(!userSnap.exists()){
      alert('User not found!');
      closeModal('rejectDepositModal');
      return;
    }
    
    const user = userSnap.val();
    const currentRejections = user.depositRejections || 0;
    const newRejections = currentRejections + 1;
    
    const updates = {
      depositRejections: newRejections
    };
    
    // Check if this is the 3rd rejection
    if(newRejections >= 3){
      const lockUntil = Date.now() + (30 * 60 * 1000); // 30 minutes
      updates.depositLockUntil = lockUntil;
    }
    
    // Update user rejection count
    await db.ref(`users/${userPhone}`).update(updates);
    
    // Update deposit request status
    await db.ref(`depositRequests/${requestId}`).update({
      status: 'rejected',
      rejectedAt: Date.now(),
      rejectedBy: 'admin',
      rejectionReason: reasonText
    });
    
    // Create rejection message for user
    let userMessage = `âŒ Your deposit of Rs ${amount} has been rejected.\nReason: ${reasonText}`;
    
    if(newRejections >= 3){
      userMessage += `\n\nâš ï¸ WARNING: You have ${newRejections} rejected deposit requests. Your account is now locked for 30 minutes.`;
    } else {
      userMessage += `\n\nâš ï¸ You have ${newRejections} rejected deposit requests (3 rejections will lock your account).`;
    }
    
    // Send message to user
    const messageRef = db.ref('adminMessages').child(userPhone).push();
    await messageRef.set({
      message: userMessage,
      timestamp: Date.now(),
      read: false
    });
    
    // Show success message
    if(newRejections >= 3){
      alert(`âŒ Deposit rejected!\n\nUser now has ${newRejections} rejections.\nAccount locked for 30 minutes.\n\nMessage sent to user.`);
    } else {
      alert(`âŒ Deposit rejected!\n\nUser now has ${newRejections} rejection(s).\n\nMessage sent to user.`);
    }
    
    // Close modal
    closeModal('rejectDepositModal');
    
    // Reload data
    loadDeposits();
    loadUsers();
    loadLockedUsers();
    updateStats();
    
  } catch(e){
    console.error('Reject deposit error:', e);
    alert('âŒ Error: ' + e.message);
  }
}

// Approve withdrawal
async function approveWithdrawal(requestId, userPhone, amount){
  if(!confirm(`Step 1: Have you sent Rs ${amount} to the user?\n\nClick OK only after sending money.`)) return;
  if(!confirm(`Step 2: Confirm approval of withdrawal request?\n\nAmount: Rs ${amount}`)) return;
  
  try {
    // Get user data
    const userSnap = await db.ref(`users/${userPhone}`).once('value');
    if(!userSnap.exists()){
      alert('User not found!');
      return;
    }
    
    const user = userSnap.val();
    
    // Check if user has enough balance
    if((user.balance || 0) < amount){
      alert('âŒ User has insufficient balance!');
      return;
    }
    
    // Update user balance
    const newBalance = Math.max(0, (user.balance || 0) - amount);
    await db.ref(`users/${userPhone}`).update({
      balance: newBalance,
      totalWithdraw: (user.totalWithdraw || 0) + amount
    });
    
    // Update withdrawal request status
    await db.ref(`withdrawRequests/${requestId}`).update({
      status: 'approved',
      approvedAt: Date.now(),
      approvedBy: 'admin'
    });
    
    // Send success message to user
    const messageRef = db.ref('adminMessages').child(userPhone).push();
    await messageRef.set({
      message: `âœ… Your withdrawal of Rs ${amount} has been approved and sent!\nNew balance: Rs ${newBalance}`,
      timestamp: Date.now(),
      read: false
    });
    
    alert('âœ… Withdrawal approved successfully!\nMoney sent to user.');
    
    // Reload data
    loadWithdrawals();
    loadUsers();
    updateStats();
    
  } catch(e){
    console.error('Approve withdrawal error:', e);
    alert('âŒ Error: ' + e.message);
  }
}

// Reject withdrawal
async function rejectWithdrawal(requestId, userPhone){
  if(!confirm('Reject this withdrawal request?\n\nUser will be notified.')) return;
  
  try {
    // Update withdrawal request status
    await db.ref(`withdrawRequests/${requestId}`).update({
      status: 'rejected',
      rejectedAt: Date.now(),
      rejectedBy: 'admin',
      rejectionReason: 'Admin rejected'
    });
    
    // Send message to user
    const messageRef = db.ref('adminMessages').child(userPhone).push();
    await messageRef.set({
      message: 'âŒ Your withdrawal request has been rejected by admin.',
      timestamp: Date.now(),
      read: false
    });
    
    alert('âœ… Withdrawal rejected!\nUser notified.');
    
    // Reload data
    loadWithdrawals();
    updateStats();
    
  } catch(e){
    console.error('Reject withdrawal error:', e);
    alert('âŒ Error: ' + e.message);
  }
}

// Edit user balance
function editUserBalance(phone, name, currentBalance){
  currentEditUser = { phone, name, currentBalance };
  
  document.getElementById('editUserName').textContent = name;
  document.getElementById('editUserPhone').textContent = phone;
  document.getElementById('editCurrentBalance').textContent = 'Rs ' + currentBalance;
  document.getElementById('editNewBalance').value = currentBalance;
  
  document.getElementById('editBalanceModal').classList.add('active');
}

// Save user balance
async function saveUserBalance(){
  const newBalance = parseFloat(document.getElementById('editNewBalance').value);
  
  if(isNaN(newBalance) || newBalance < 0){
    alert('Please enter a valid balance (0 or higher)');
    return;
  }
  
  if(!currentEditUser) return;
  
  if(!confirm(`Change balance from Rs ${currentEditUser.currentBalance} to Rs ${newBalance}?\n\nFor user: ${currentEditUser.name} (${currentEditUser.phone})`)) return;
  
  try {
    await db.ref(`users/${currentEditUser.phone}`).update({
      balance: newBalance
    });
    
    // Send notification to user
    const messageRef = db.ref('adminMessages').child(currentEditUser.phone).push();
    await messageRef.set({
      message: `ğŸ“Š Your balance has been updated by admin.\nNew balance: Rs ${newBalance}`,
      timestamp: Date.now(),
      read: false
    });
    
    alert('âœ… Balance updated successfully!');
    closeModal('editBalanceModal');
    
    // Reload users
    loadUsers();
    loadLockedUsers();
    
  } catch(e){
    console.error('Save balance error:', e);
    alert('âŒ Error: ' + e.message);
  }
}

// Send message to user
function sendMessageToUser(phone, name){
  currentMessageUser = { phone, name };
  
  document.getElementById('msgUserName').textContent = name;
  document.getElementById('msgUserPhone').textContent = phone;
  document.getElementById('adminMessageText').value = '';
  
  document.getElementById('sendMessageModal').classList.add('active');
}

// Send admin message
async function sendAdminMessage(){
  const message = document.getElementById('adminMessageText').value.trim();
  
  if(!message){
    alert('Please enter a message!');
    return;
  }
  
  if(!currentMessageUser) return;
  
  if(!confirm(`Send message to ${currentMessageUser.name} (${currentMessageUser.phone})?`)) return;
  
  try {
    const messageRef = db.ref('adminMessages').child(currentMessageUser.phone).push();
    await messageRef.set({
      message: message,
      timestamp: Date.now(),
      read: false
    });
    
    alert('âœ… Message sent successfully!');
    closeModal('sendMessageModal');
    
  } catch(e){
    console.error('Send message error:', e);
    alert('âŒ Error: ' + e.message);
  }
}

// Unlock user
async function unlockUser(phone){
  if(!confirm('Unlock this user?\n\nThey will be able to make deposits again.')) return;
  
  try {
    await db.ref(`users/${phone}`).update({
      depositRejections: 0,
      depositLockUntil: null
    });
    
    // Send notification to user
    const messageRef = db.ref('adminMessages').child(phone).push();
    await messageRef.set({
      message: 'ğŸ”“ Your account has been unlocked by admin. You can now make deposits again.',
      timestamp: Date.now(),
      read: false
    });
    
    alert('âœ… User unlocked successfully!');
    
    // Reload data
    loadUsers();
    loadLockedUsers();
    
  } catch(e){
    console.error('Unlock user error:', e);
    alert('âŒ Error: ' + e.message);
  }
}

// Show ban user modal
function showBanUserModal(phone, name){
  currentBanUser = { phone, name };
  
  document.getElementById('banUserName').textContent = name;
  document.getElementById('banUserPhone').textContent = 'Phone: ' + phone;
  document.getElementById('banReason').value = '';
  
  document.getElementById('banUserModal').classList.add('active');
}

// Confirm ban user
async function confirmBanUser(){
  const reason = document.getElementById('banReason').value.trim();
  const reasonText = reason ? `\nReason: ${reason}` : '';
  
  if(!confirm(`PERMANENTLY BAN ${currentBanUser.name} (${currentBanUser.phone})?${reasonText}\n\nâš ï¸ This action cannot be undone!`)) return;
  
  try {
    // Get user data first
    const userSnap = await db.ref(`users/${currentBanUser.phone}`).once('value');
    if(!userSnap.exists()){
      alert('User not found!');
      closeModal('banUserModal');
      return;
    }
    
    const user = userSnap.val();
    const namePairKey = user.name ? `${user.name}_${currentBanUser.phone}` : null;
    
    const updates = {};
    
    // Ban the user
    updates[`users/${currentBanUser.phone}/banned`] = true;
    updates[`users/${currentBanUser.phone}/isOnline`] = false;
    updates[`users/${currentBanUser.phone}/deviceId`] = null;
    updates[`users/${currentBanUser.phone}/bannedAt`] = Date.now();
    if(reason) updates[`users/${currentBanUser.phone}/banReason`] = reason;
    
    // Add to banned phones list
    updates[`bannedPhones/${currentBanUser.phone}`] = {
      banned: true,
      bannedAt: Date.now(),
      name: user.name || 'Unknown',
      bannedBy: 'admin',
      reason: reason || 'No reason provided'
    };
    
    // Remove from device tracking
    if(user.deviceId){
      updates[`deviceTracking/${user.deviceId}/users/${currentBanUser.phone}`] = null;
    }
    
    // Lock the name-phone pair permanently
    if(namePairKey){
      updates[`namePhonePairs/${namePairKey}/banned`] = true;
      updates[`namePhonePairs/${namePairKey}/bannedAt`] = Date.now();
      if(reason) updates[`namePhonePairs/${namePairKey}/banReason`] = reason;
    }
    
    await db.ref().update(updates);
    
    alert(`âœ… User permanently banned!\n\nPhone number: ${currentBanUser.phone}\nName: ${currentBanUser.name}\n${reason ? 'Reason: ' + reason : ''}`);
    
    closeModal('banUserModal');
    
    // Reload data
    loadUsers();
    loadLockedUsers();
    updateStats();
    
  } catch(e){
    console.error('Ban user error:', e);
    alert('âŒ Error: ' + e.message);
  }
}

// Delete user
async function deleteUser(phone, name){
  if(!confirm(`âš ï¸ DELETE USER: ${name} (${phone})\n\nThis will:\nâ€¢ Remove all user data\nâ€¢ Delete deposit/withdrawal history\nâ€¢ Delete from device tracking\n\nThis action cannot be undone!`)) return;
  if(!confirm(`FINAL WARNING: Delete ${name} (${phone})?\n\nType "DELETE" to confirm:`)){
    const userInput = prompt('Type "DELETE" to confirm deletion:');
    if(userInput !== 'DELETE') return;
  }
  
  try {
    // Get user data first
    const userSnap = await db.ref(`users/${phone}`).once('value');
    if(!userSnap.exists()){
      alert('User not found!');
      return;
    }
    
    const user = userSnap.val();
    const namePairKey = user.name ? `${user.name}_${phone}` : null;
    
    const updates = {};
    
    // Delete user
    updates[`users/${phone}`] = null;
    
    // Delete from device tracking
    if(user.deviceId){
      updates[`deviceTracking/${user.deviceId}/users/${phone}`] = null;
    }
    
    // Delete name-phone pair lock
    if(namePairKey){
      updates[`namePhonePairs/${namePairKey}`] = null;
    }
    
    // Delete deposit requests
    const depositsSnap = await db.ref('depositRequests').once('value');
    if(depositsSnap.exists()){
      depositsSnap.forEach(child => {
        if(child.val().phone === phone){
          updates[`depositRequests/${child.key}`] = null;
        }
      });
    }
    
    // Delete withdrawal requests
    const withdrawsSnap = await db.ref('withdrawRequests').once('value');
    if(withdrawsSnap.exists()){
      withdrawsSnap.forEach(child => {
        if(child.val().phone === phone){
          updates[`withdrawRequests/${child.key}`] = null;
        }
      });
    }
    
    // Delete admin messages
    updates[`adminMessages/${phone}`] = null;
    
    await db.ref().update(updates);
    
    alert('âœ… User and all related data deleted!');
    
    // Reload data
    loadUsers();
    loadDeposits();
    loadWithdrawals();
    loadLockedUsers();
    updateStats();
    
  } catch(e){
    console.error('Delete user error:', e);
    alert('âŒ Error: ' + e.message);
  }
}

// View user details
async function viewUserDetails(phone){
  try {
    const userSnap = await db.ref(`users/${phone}`).once('value');
    if(!userSnap.exists()){
      alert('User not found!');
      return;
    }
    
    const user = userSnap.val();
    let message = `ğŸ‘¤ USER DETAILS\n\n`;
    message += `Name: ${user.name || 'N/A'}\n`;
    message += `Phone: ${phone}\n`;
    message += `Balance: Rs ${user.balance || 0}\n`;
    message += `Total Deposits: Rs ${user.totalDeposit || 0}\n`;
    message += `Total Withdrawals: Rs ${user.totalWithdraw || 0}\n`;
    message += `Deposit Rejections: ${user.depositRejections || 0}/3\n`;
    
    if(user.depositLockUntil && user.depositLockUntil > Date.now()){
      const remaining = Math.ceil((user.depositLockUntil - Date.now()) / 60000);
      message += `ğŸ”’ Locked: ${remaining} minutes remaining\n`;
    }
    
    message += `Status: ${user.isOnline ? 'ğŸŸ¢ Online' : 'ğŸ”´ Offline'}\n`;
    message += `Banned: ${user.banned ? 'âœ… Yes' : 'âŒ No'}\n`;
    message += `Device ID: ${user.deviceId ? user.deviceId.substring(0,20) + '...' : 'N/A'}\n`;
    message += `Last Login: ${user.lastLogin ? new Date(user.lastLogin).toLocaleString() : 'N/A'}\n`;
    message += `Created: ${user.createdAt ? new Date(user.createdAt).toLocaleString() : 'N/A'}`;
    
    alert(message);
    
  } catch(e){
    console.error('View user details error:', e);
    alert('âŒ Error: ' + e.message);
  }
}

// Close modal
function closeModal(modalId){
  document.getElementById(modalId).classList.remove('active');
  
  // Reset data
  if(modalId === 'rejectDepositModal'){
    currentRejectData = null;
  } else if(modalId === 'editBalanceModal'){
    currentEditUser = null;
  } else if(modalId === 'sendMessageModal'){
    currentMessageUser = null;
  } else if(modalId === 'banUserModal'){
    currentBanUser = null;
  }
}
</script>

</body>
</html>